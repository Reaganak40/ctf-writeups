#!/usr/bin/env python3

from pwn import *
import subprocess

TARGET_CODE = 0x21DD09EC

# Create a passcode that will match the hash in col.c
passcode = b'\x04' * 16
curr_total = int.from_bytes(b'\x04' * 4) * 4
diff = TARGET_CODE - curr_total
passcode += diff.to_bytes(4, 'little')

# fetch the flag
io = ssh(host='pwnable.kr', user='col', password='guest', port=2222)
flag = io.process(["./col", passcode]).recvall()
io.close()

print(flag.decode())

